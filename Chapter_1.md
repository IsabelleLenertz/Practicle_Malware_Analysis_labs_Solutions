Practicle Malware Analysis
Chapter 1

Lab 1

1. Submission to virus total.
Lab01-01.exe is flaged by 53/71 vendors and 1 sandbox
Lab01-01.dll is flaged by 44/71 vendors and no sandbox

2. When were thos files compiled?
Lab01-01.exe was compiled on 2010/12/19, 16:16:19 UTC
Lab01-01.dll was compiled on 2010/12/19, 16:16:38 UTC

3. Are the files packed or obfuscated?
Both file have a good number of string even though the dll has little inteligible strings
PEid indicate the file have been packed with visual studio. I am not sure if the files have actually be packed or if this is only the IDE/compiler used.
Let's look at the disk size vs virtual size using PEview. Lab01-01.exe has non-0 virtual size for the different sections.
I am concluding the the files are not packed.

4. Do any import hint at what the malware does? Which ones?
EXE file: Looks like there are functions crawling through the file system copying/creating files.
* CopyFile
* CreateFile
* FindFirstFile
* FindNextFile
DLL file: 
* CreateProcess
* Sleep

Lab 2
1. virustotal
Yes, it's detected by most vendors

2. Are there any indication that the files are packed or obsucated? If so, what are the indicators? If packed, unpack it is possible.
Looking at the strings literal in the program reveal little inteligible data. this may indicate a packed or obfuscated program.
PeID indicates that the file is packed with upx, I could decode is by using upx -d <file location>
Now we can see more string in the program, notably reference to a website that we could use to look for network connections to detect affected machines: malwareanalysisbook.com
Let's look at dependency walker next:
imports:
- Kernel32 (core functionality such as memory access and manipulation, files, hardware)
* LoadLibrary
* GetProAddress
* VirtualProtect
* VirtualAlloc
* VirtualFree
* ExitProcess
- ADAVPI32: (service management and registry)
* create service
- MSVCRT
* exit
-WININET: (high level networking functionality)
* InternetOpen

Looking at PE headers now, there is no .txt header.
Conclusion: In addition to PeID recognizing this as a packed program, other indicator clearly shown that it is. We'll continue the analysis looking at the unpacked version of the file

3. Do any import hint at the program's functionality? If so, which import are they and what do they tell you?
Looking at new imports:
InternetOpen and InternetOpenUrl seem to indicate that the malware navigates to a specific web page
setWaitableTimer and CreateWaitableTimer see to indicate that the malware implements some kinf of waiting period
CreateService: starts a service that runs in the background

4. What host or network-based indicators could be used idetify this malware on infected hosts?
Going back to the string in the unpacked executable:
We can see MalSerivice and Malservice that are probably in relation with the CreateService import.
The url hxxp://malwareanalysisbook.com is probably the url that the malware navigates to
Internet Explorer 8.0: I am not certain where this one commes in play. maybe the browser used to nativate the given url?

Indicators:
* network traffic to hxxp://malwareanalysisbook.com
* host running a service call MalService or Malservice

Lab 3
1. viruts total
Yes, it's detected by most vendors as a troja horse or a spyware. However, it is not detected by sandboxes - which is to be expected since this does not actually have malicious behavior.
We also see that the same file has different name, notably lab-18-2.exe and lab-2-2.exe hinting that we'll analysis this file in further chapters. Since it appears in chapter 18 this executable might be packed

2. Are there any indication that the files are packed or obsucated? If so, what are the indicators? If packed, unpack it is possible.
- few inteligible strings in the executable file
- PEID shows that the file is packed using FSG 1.0. We can't unpack at this point of the book.
- the first section header (unnamed) has a raw size of 0 but a large virtual size. this is probably were the code will be unpacked.

3. Do any import hint at the program's functionality? If so, which import are they and what do they tell you?
This cannot be answered since the file cannot yet be unpacked.

4. What host or network-based indicators could be used idetify this malware on infected hosts?
This cannot be answered since the file cannot yet be unpacked.
